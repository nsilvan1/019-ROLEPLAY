-----------------------------------------------------------------------------------------------------------------------------------------
-- CONNECTION
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel") 
local Proxy = module("vrp","lib/Proxy")

cRP = {}
Tunnel.bindInterface("vrp_corrida",cRP)
vCORRIDAS = Tunnel.getInterface("vrp_corrida")
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIAVEIS
-----------------------------------------------------------------------------------------------------------------------------------------
local blips = false
local inrace = false
local timerace = 0
local racepoint = 1
local racepos = 0
local CoordenadaX = 385.29 --  385.29,-1657.45,27.30
local CoordenadaY = -1657.45
local CoordenadaZ = 27.30
local PlateIndex = nil
local bomba = nil
local explosive = 0
local checkpoint
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIAVEIS
-----------------------------------------------------------------------------------------------------------------------------------------
local races = {
	[1] = {
		['time'] = 245,
		[1] = { ['x'] = 342.12249755859, ['y'] = -1711.5548095703, ['z'] = 29.266284942627 },
		[2] = { ['x'] = 352.92163085938, ['y'] = -1739.1951904297, ['z'] = 29.253469467163},
		[3] = { ['x'] = 821.94, ['y'] = -1871.34, ['z'] = 28.69 },
		[4] = { ['x'] = 1269.87, ['y'] = -1662.22, ['z'] = 46.72 },
		[5] = { ['x'] = 1160.43, ['y'] = -846.89, ['z'] = 54.53},
		[6] = { ['x'] = 190.38, ['y'] = -770.57, ['z'] = 31.78 },
		[7] = { ['x'] = 91.02, ['y'] = -638.16, ['z'] = 31.01 },
		[8] = { ['x'] = 15.47, ['y'] = -337.53, ['z'] = 42.98 },
		[9] = { ['x'] = -315.46, ['y'] = -179.68, ['z'] = 38.90 },
		[10] = { ['x'] = -407.52, ['y'] = -56.98, ['z'] = 44.37 },
		[11] = { ['x'] = -617.12, ['y'] = 268.80, ['z'] = 81.12 },
		[12] = { ['x'] = -1005.33, ['y'] = 271.99, ['z'] = 66.08 },
		[13] = { ['x'] = -695.31, ['y'] = -364.62, ['z'] = 33.80 },
		[14] = { ['x'] = -643.20, ['y'] = -768.60, ['z'] = 24.98 },
		[15] = { ['x'] = -71.02, ['y'] = -1030.23, ['z'] = 28.02 },
		[16] = { ['x'] = -74.73, ['y'] = -1262.74, ['z'] = 28.99 }
   },
	[2] = {
		['time'] = 245,
		[1] = { ['x'] = 165.61, ['y'] = -1971.98, ['z'] = 18.12 },
		[2] = { ['x'] = 436.74, ['y'] = -2121.32, ['z'] = 19.62 },
		[3] = { ['x'] = 821.94, ['y'] = -1871.34, ['z'] = 28.69 },
		[4] = { ['x'] = 1269.87, ['y'] = -1662.22, ['z'] = 46.72 },
		[5] = { ['x'] = 1160.43, ['y'] = -846.89, ['z'] = 54.53},
		[6] = { ['x'] = 190.38, ['y'] = -770.57, ['z'] = 31.78 },
		[7] = { ['x'] = 91.02, ['y'] = -638.16, ['z'] = 31.01 },
		[8] = { ['x'] = 15.47, ['y'] = -337.53, ['z'] = 42.98 },
		[9] = { ['x'] = -315.46, ['y'] = -179.68, ['z'] = 38.90 },
		[10] = { ['x'] = -407.52, ['y'] = -56.98, ['z'] = 44.37 },
		[11] = { ['x'] = -617.12, ['y'] = 268.80, ['z'] = 81.12 },
		[12] = { ['x'] = -1005.33, ['y'] = 271.99, ['z'] = 66.08 },
		[13] = { ['x'] = -695.31, ['y'] = -364.62, ['z'] = 33.80 },
		[14] = { ['x'] = -643.20, ['y'] = -768.60, ['z'] = 24.98 },
		[15] = { ['x'] = -71.02, ['y'] = -1030.23, ['z'] = 28.02 },
		[16] = { ['x'] = -74.73, ['y'] = -1262.74, ['z'] = 28.99 }
	},
	[3] = {
		['time'] = 165,
		[1] = { ['x'] = 308.71, ['y'] = -1518.34, ['z'] = 29.34 },
		[2] = { ['x'] = 502.26, ['y'] = -1239.87, ['z'] = 29.34},
		[3] = { ['x'] = 111.79, ['y'] = -792.34, ['z'] = 30.82 },
		[4] = { ['x'] = -145.59, ['y'] = -1378.70, ['z'] = 29.61 },
		[5] = { ['x'] = -407.36, ['y'] = -1744.18, ['z'] = 19.36 },
		[6] = { ['x'] = -178.89, ['y'] = -1790.34, ['z'] = 29.26 },
		[7] = { ['x'] = 129.59, ['y'] = -1875.25, ['z'] = 23.31 },
		[8] = { ['x'] = 513.65, ['y'] = -1594.59, ['z'] = 28.67 },
		[9] = { ['x'] = 500.92, ['y'] = -1012.51, ['z'] = 27.38 },
		[10] = { ['x'] = 406.14, ['y'] = -881.92, ['z'] = 28.82 },
		[11] = {['x'] = -13.12, ['y'] = -906.28, ['z'] = 29.69},
		[12] = {['x'] = -98.00, ['y'] = -1136.59, ['z'] = 25.82},
		[13] = {['x'] = -76.93, ['y'] = -1317.55, ['z'] = 29.02},
	},
	[4] = {
		['time'] = 180,
		[1] = { ['x'] = 214.15, ['y'] = -1419.41, ['z'] = 28.70 },
		[2] = { ['x'] = -270.678, ['y'] = -1138.91, ['z'] = 23.10 },
		[3] = { ['x'] = -550.31, ['y'] = -831.70, ['z'] = 27.69 },
		[4] = { ['x'] = -625.90, ['y'] = -449.84, ['z'] = 34.18 },
		[5] = { ['x'] = -1341.41, ['y'] = -49.03, ['z'] = 50.42 },
		[6] = { ['x'] = -1668.49, ['y'] = -479.43, ['z'] = 37.85 },
		[7] = { ['x'] = -1932.74, ['y'] = -436.20, ['z'] = 19.35 },
		[8] = { ['x'] = -1935.61, ['y'] = -513.14, ['z'] = 11.21 },
		[9] = { ['x'] = -1265.27, ['y'] = -733.15, ['z'] = 10.45 },
		[10] = { ['x'] = -687.11, ['y'] = -554.89, ['z'] = 33.51 },
		[11] = { ['x'] = -575.23, ['y'] = -836.39, ['z'] = 25.89 },
		[12] = { ['x'] = -72.89, ['y'] = -1035.51, ['z'] = 27.63 },
		[13] = { ['x'] = -330.16, ['y'] = -1008.51, ['z'] = 30.21 }
	},
	[5] = {
		['time'] = 175,
		[1] = { ['x'] = 480.59, ['y'] = -1660.33, ['z'] = 28.65 },
		[2] = { ['x'] = 434.92, ['y'] = -1860.17, ['z'] = 26.93 },
		[3] = { ['x'] = 658.88, ['y'] = -2062.74, ['z'] = 28.69 },
		[4] = { ['x'] = 828.93, ['y'] = -1831.54, ['z'] = 28.53 },
		[5] = { ['x'] = 423.23, ['y'] = -1589.83, ['z'] = 28.70 },
		[6] = { ['x'] = 449.56, ['y'] = -1447.40, ['z'] = 28.71 },
		[7] = { ['x'] = 503.66, ['y'] = -771.21, ['z'] = 24.27 },
		[8] = { ['x'] = 200.97, ['y'] = -599.41, ['z'] = 28.72 },
		[9] = { ['x'] = -4.09, ['y'] = -873.96, ['z'] = 29.60 },
		[10] = { ['x'] = 678.26, ['y'] = -1021.00, ['z'] = 34.71 },
		[11] = { ['x'] = 565.80, ['y'] = -345.86, ['z'] = 42.97 },
		[12] = { ['x'] = 260.11, ['y'] = -564.07, ['z'] = 42.68 },
		[13] = { ['x'] = 84.17, ['y'] = -604.58, ['z'] = 43.63 },
		[14] = { ['x'] = -156.91, ['y'] = -699.22, ['z'] = 37.26 },
		[15] = { ['x'] = -264.28, ['y'] = -792.08, ['z'] = 31.61 },
		[16] = { ['x'] = -110.73, ['y'] = -924.80, ['z'] = 28.70 },
		[17] = { ['x'] = -81.27, ['y'] = -1058.17, ['z'] = 26.89 },
		[18] = { ['x'] = -142.20, ['y'] = -1352.27, ['z'] = 29.57 }
   },
	[6] = {
		['time'] = 185,
		[1] = { ['x'] = 519.49, ['y'] = -1587.41, ['z'] = 28.65 },
		[2] = { ['x'] = 310.50, ['y'] = -1299.87, ['z'] = 30.65 },
		[3] = { ['x'] = 92.53, ['y'] = -1334.47, ['z'] = 29.34 },
		[4] = { ['x'] = -29.67, ['y'] = -1133.60, ['z'] = 26.11 },
		[5] = { ['x'] = 162.81, ['y'] = -411.53, ['z'] = 40.51 },
		[6] = { ['x'] = -38.10, ['y'] = -248.99, ['z'] = 45.42 },
		[7] = { ['x'] = -53.22, ['y'] = -28.83, ['z'] = 65.98 },
		[8] = { ['x'] = -484.34, ['y'] = 132.44, ['z'] = 63.17 },
		[9] = { ['x'] = -557.28, ['y'] = -16.91, ['z'] = 43.38 },
		[10] = { ['x'] = -231.27, ['y'] = -585.64, ['z'] = 33.81 },
		[11] = { ['x'] = -270.67, ['y'] = -1138.91, ['z'] = 23.10},
		[12] = { ['x'] = 191.65, ['y'] = -1330.94, ['z'] = 28.71 },
		[13] = { ['x'] = 70.44, ['y'] = -1212.79, ['z'] = 28.70 },
		[14] = { ['x'] = 29.45, ['y'] = -1037.63, ['z'] = 29.34 }
	},
	[7] = {
		['time'] = 232,
		[1] = { ['x'] = 335.14, ['y'] = -1712.75, ['z'] = 28.68 },
		[2] = { ['x'] = 211.85, ['y'] = -1606.84, ['z'] = 28.54 },
		[3] = { ['x'] = 307.73, ['y'] = -1505.671, ['z'] = 28.51 },
		[4] = { ['x'] = 97.531, ['y'] = -1332.79, ['z'] = 28.69 },
		[5] = { ['x'] = 96.705, ['y'] = -1021.18, ['z'] = 28.76 },
		[6] = { ['x'] = -9.74, ['y'] = -947.58, ['z'] = 28.75 },
		[7] = { ['x'] = 184.54, ['y'] = -353.73, ['z'] = 43.48 },
		[8] = { ['x'] = 40.72, ['y'] = -278.16, ['z'] = 46.89 },
		[9] = { ['x'] = 49.153, ['y'] = -237.45, ['z'] = 48.81 },
		[10] = { ['x'] = -84.20, ['y'] = -181.99, ['z'] = 49.06 },
		[11] = { ['x'] = 33.56, ['y'] = 246.48, ['z'] = 108.96 },
		[12] = { ['x'] = 230.57, ['y'] = 440.72, ['z'] = 119.76 },
		[13] = { ['x'] = 316.76, ['y'] = 992.26, ['z'] = 209.92 },
		[14] = { ['x'] = 240.13, ['y'] = 1330.83, ['z'] = 237.85},
		[15] = { ['x'] = 99.00, ['y'] = 1392.28, ['z'] = 259.32},
		[16] = { ['x'] = -130.49, ['y'] = 1512.14, ['z'] = 287.65},
		[17] = { ['x'] = -208.53, ['y'] = 1305.024, ['z'] = 305.18},
		[18] = { ['x'] = -365.24, ['y'] = 1173.45, ['z'] = 325.63},
		[19] = { ['x'] = -503.27, ['y'] = 1215.94, ['z'] = 322.61},
		[20] = { ['x'] = -476.87, ['y'] = 1356.21, ['z'] = 303.62},
		[21] = { ['x'] = -665.17, ['y'] = 1225.17, ['z'] = 270.47},
		[22] = { ['x'] = -714.96, ['y'] = 989.09, ['z'] = 237.39 },
		[23] = { ['x'] = -576.16, ['y'] = 849.85, ['z'] = 203.47 },
		[24] = { ['x'] = -530.44, ['y'] = 667.84, ['z'] = 141.80 },
		[25] = { ['x'] = -551.12, ['y'] = 523.79, ['z'] = 106.84 },
		[26] = { ['x'] = -537.13, ['y'] = 282.52, ['z'] = 82.41 },
		[27] = { ['x'] = -552.993, ['y'] = 15.41, ['z'] = 43.78 },
		[28] = { ['x'] = -530.88, ['y'] = -28.67, ['z'] = 43.84 },
	},
	[8] = {
		['time'] = 210,
		[1] = { ['x'] = 335.53, ['y'] = -1717.67, ['z'] = 28.77 },
		[2] = { ['x'] = 507.43, ['y'] = -1892.27, ['z'] = 24.95 },
		[3] = { ['x'] = 604.60, ['y'] = -1608.22, ['z'] = 25.22 },
		[4] = { ['x'] = 526.46, ['y'] = -1482.61, ['z'] = 28.70 },
		[5] = { ['x'] = 285.75, ['y'] = -1298.87, ['z'] = 29.38 },
		[6] = { ['x'] = 219.73, ['y'] = -1098.54, ['z'] = 28.66 },
		[7] = { ['x'] = 343.99, ['y'] = -707.56, ['z'] = 28.66 },
		[8] = { ['x'] = 870.30, ['y'] = 119.34, ['z'] = 70.41 },
		[9] = { ['x'] = 1131.37, ['y'] = 373.74, ['z'] = 90.85 },
		[10] = { ['x'] = 1017.07, ['y'] = 495.74, ['z'] = 96.69 },
		[11] = { ['x'] = 768.10, ['y'] = 614.87, ['z'] = 125.13 },
		[12] = { ['x'] = 658.10, ['y'] = 654.93, ['z'] = 128.25 },
		[13] = { ['x'] = 600.13, ['y'] = 617.46, ['z'] = 128.26 },
		[14] = { ['x'] = 635.97, ['y'] = 596.89, ['z'] = 128.26 },
		[15] = { ['x'] = 657.17, ['y'] = 632.51, ['z'] = 128.26 },
		[16] = { ['x'] = 821.21, ['y'] = 558.95, ['z'] = 125.12 },
		[17] = { ['x'] = 904.07, ['y'] = 527.47, ['z'] = 121.61 },
		[18] = { ['x'] = 675.62, ['y'] = 345.10, ['z'] = 110.47 },
		[19] = { ['x'] = 467.15, ['y'] = 399.42, ['z'] = 138.41 },
		[20] = { ['x'] = 285.62, ['y'] = 606.71, ['z'] = 153.76 },
		[21] = { ['x'] = 240.28, ['y'] = 458.70, ['z'] = 122.54 },
		[22] = { ['x'] = 261.20, ['y'] = 351.30, ['z'] = 104.82 },
		[23] = { ['x'] = 121.71, ['y'] = -33.15, ['z'] = 67.06 },
		[24] = { ['x'] = -100.80, ['y'] = -650.59, ['z'] = 35.54 },
		[25] = { ['x'] = -226.56, ['y'] = -665.89, ['z'] = 32.81 },
		[26] = { ['x'] = -336.06, ['y'] = -687.58, ['z'] = 32.29 },
		[27] = { ['x'] = -353.86, ['y'] = -821.96, ['z'] = 30.84 },
		[28] = { ['x'] = -356.24, ['y'] = -951.80, ['z'] = 30.43 },
		[29] = { ['x'] = -244.01, ['y'] = -999.57, ['z'] = 28.45 },
		[30] = { ['x'] = -278.71, ['y'] = -1398.89, ['z'] = 30.69 },
		[31] = { ['x'] = -135.36, ['y'] = -1526.19, ['z'] = 33.64 },
		[32] = { ['x'] = -75.55, ['y'] = -1460.27, ['z'] = 31.47 },
		[33] = { ['x'] = -90.29, ['y'] = -1420.95, ['z'] = 28.99 },	
	},
	[9] = {
		['time'] = 116,
		[1] = { ['x'] = 334.08, ['y'] = -1719.05, ['z'] = 28.76 },
		[2] = { ['x'] = 408.66, ['y'] = -1720.89, ['z'] = 28.67 },
		[3] = { ['x'] = 492.98, ['y'] = -1669.86, ['z'] = 28.67 },
		[4] = { ['x'] = 798.41, ['y'] = -1751.14, ['z'] = 28.72 },
		[5] = { ['x'] = 734.75, ['y'] = -2361.08, ['z'] = 22.63 },
		[6] = { ['x'] = 601.17, ['y'] = -2513.41, ['z'] = 16.15 },
		[7] = { ['x'] = 556.09, ['y'] = -2550.93, ['z'] = 5.69 },
		[8] = { ['x'] = 350.77, ['y'] = -2500.41, ['z'] = 5.52 },
		[9] = { ['x'] = 358.15, ['y'] = -2251.83, ['z'] = 9.53 },
		[10] = { ['x'] = 282.89, ['y'] = -2116.57, ['z'] = 15.31 },
		[11] = { ['x'] = -59.49, ['y'] = -2052.72, ['z'] = 20.75 },
		[12] = { ['x'] = -332.87, ['y'] = -2085.31, ['z'] = 23.21 },
		[13] = { ['x'] = -453.01, ['y'] = -1972.26, ['z'] = 24.03 },
		[14] = { ['x'] = -404.36, ['y'] = -1845.52, ['z'] = 20.07 },
		[15] = { ['x'] = -396.20, ['y'] = -1748.66, ['z'] = 19.462 },
		[16] = { ['x'] = -368.95, ['y'] = -1527.77, ['z'] = 27.15 },
	},
	[10] = {
		['time'] = 218,
		[1] = { ['x'] = 312.00, ['y'] = -1699.20, ['z'] = 28.77},
		[2] = { ['x'] = 156.74, ['y'] = -1580.31, ['z'] = 28.62},
		[3] = { ['x'] = 52.91, ['y'] = -1529.96, ['z'] = 28.66},
		[4] = { ['x'] = -83.79, ['y'] = -1546.26, ['z'] = 32.22},
		[5] = { ['x'] = -274.45, ['y'] = -1329.82, ['z'] = 30.70},
		[6] = { ['x'] = -219.85, ['y'] = -995.47, ['z'] = 28.69},
		[7] = { ['x'] = -17.97, ['y'] = -435.12, ['z'] = 39.62},
		[8] = { ['x'] = 67.30, ['y'] = -184.94, ['z'] = 54.41},
		[9] = { ['x'] = -390.11, ['y'] = 15.22, ['z'] = 46.29},
		[10] = { ['x'] = -419.25, ['y'] = 126.94, ['z'] = 64.51},
		[11] = { ['x'] = -543.90, ['y'] = 160.68, ['z'] = 64.77},
		[12] = { ['x'] = -532.65, ['y'] = 402.06, ['z'] = 89.96},
		[13] = { ['x'] = -556.76, ['y'] = 515.01, ['z'] = 105.37},
		[14] = { ['x'] = -660.78, ['y'] = 697.14, ['z'] = 152.48},
		[15] = { ['x'] = -615.68, ['y'] = 743.01, ['z'] = 179.69},
		[16] = { ['x'] = -745.65, ['y'] = 828.72, ['z'] = 213.45},
		[17] = { ['x'] = -722.67, ['y'] = 979.42, ['z'] = 237.32},
		[18] = { ['x'] = -1145.46, ['y'] = 1060.89, ['z'] = 207.53},
		[19] = { ['x'] = -1429.06, ['y'] = 780.94, ['z'] = 182.61},
		[20] = { ['x'] = -1641.52, ['y'] = 993.21, ['z'] = 152.14},
		[21] = { ['x'] = -1901.53, ['y'] = 696.42, ['z'] = 126.93},
		[22] = { ['x'] = -1815.33, ['y'] = 95.85, ['z'] = 72.82},
		[23] = { ['x'] = -2029.48, ['y'] = 170.49, ['z'] = 109.72},
		[24] = { ['x'] = -2301.74, ['y'] = 482.11, ['z'] = 173.58},
		[25] = { ['x'] = -2318.50, ['y'] = 392.33, ['z'] = 173.83},
	},
	[11] = {
		['time'] = 390,
		[1] = { ['x'] = 339.56, ['y'] = -1719.29, ['z'] = 28.71 },
		[2] = { ['x'] = 313.45, ['y'] = -1793.44, ['z'] = 27.38 },
		[3] = { ['x'] = 295.41, ['y'] = -1891.57, ['z'] = 26.33 },
		[4] = { ['x'] = 536.76, ['y'] = -2052.76, ['z'] = 27.44 },
		[5] = { ['x'] = 757.82, ['y'] = -2112.98, ['z'] = 28.68 },
		[6] = { ['x'] = 719.81, ['y'] = -3057.27, ['z'] = 12.09 },
		[7] = { ['x'] = 1077.40, ['y'] = -3330.07, ['z'] = 5.257 },
		[8] = { ['x'] = 1187.41, ['y'] = -3219.88, ['z'] = 5.157 },
		[9] = { ['x'] = 1258.51, ['y'] = -3191.76, ['z'] = 5.157 },
		[10] = { ['x'] = 1239.42, ['y'] = -3091.44, ['z'] = 5.16 },
		[11] = { ['x'] = 1144.02, ['y'] = -3115.09, ['z'] = 5.14 },
		[12] = { ['x'] = 1077.44, ['y'] = -3125.69, ['z'] = 5.26 },
		[13] = { ['x'] = 1077.44, ['y'] = -3209.89, ['z'] = 5.24 },
		[14] = { ['x'] = 981.33, ['y'] = -3222.91, ['z'] = 5.26 },
		[15] = { ['x'] = 981.52, ['y'] = -3119.21, ['z'] = 5.27 },
		[16] = { ['x'] = 928.98, ['y'] = -2946.54, ['z'] = 5.25 },
		[17] = { ['x'] = 864.60, ['y'] = -3006.78, ['z'] = 5.27 },
		[18] = { ['x'] = 869.02, ['y'] = -2958.79, ['z'] = 5.27 },
		[19] = { ['x'] = 896.95, ['y'] = -3005.09, ['z'] = 5.27 },
		[20] = { ['x'] = 977.43, ['y'] = -3030.68, ['z'] = 5.26 },
		[21] = { ['x'] = 876.14, ['y'] = -3062.40, ['z'] = 5.24 },
		[22] = { ['x'] = 807.89, ['y'] = -3109.58, ['z'] = 5.25 },
		[23] = { ['x'] = 866.58, ['y'] = -3112.85, ['z'] = 5.27 },
		[24] = { ['x'] = 781.83, ['y'] = -3089.05, ['z'] = 5.15 },
		[25] = { ['x'] = 719.272, ['y'] = -2543.05, ['z'] = 19.21 },
		[26] = { ['x'] = 348.837, ['y'] = -2500.62, ['z'] = 5.46 },
		[27] = { ['x'] = 356.762, ['y'] = -2191.65, ['z'] = 12.38 },
		[28] = { ['x'] = 116.549, ['y'] = -2035.80, ['z'] = 17.69 },
		[29] = { ['x'] = -150.89, ['y'] = -2087.29, ['z'] = 25.10 },
		[30] = { ['x'] = -399.19, ['y'] = -2099.14, ['z'] = 25.62 },
		[31] = { ['x'] = -615.96, ['y'] = -2086.53, ['z'] = 20.96 },
		[32] = { ['x'] = -742.43, ['y'] = -2168.27, ['z'] = 13.68 },
		[33] = { ['x'] = -828.43, ['y'] = -2225.37, ['z'] = 16.74 },
		[34] = { ['x'] = -1083.1, ['y'] = -2596.95, ['z'] = 19.50 },
		[35] = { ['x'] = -960.21, ['y'] = -2741.21, ['z'] = 19.48 },
		[36] = { ['x'] = -892.78, ['y'] = -2686.25, ['z'] = 19.52 },
		[37] = { ['x'] = -796.41, ['y'] = -2523.53, ['z'] = 13.11 },
		[38] = { ['x'] = -660.55, ['y'] = -2323.38, ['z'] = 8.86 },
		[39] = { ['x'] = -515.54, ['y'] = -2121.20, ['z'] = 8.44 },
		[40] = { ['x'] = -798.85, ['y'] = -1989.93, ['z'] = 8.54 },
		[41] = { ['x'] = -964.62, ['y'] = -2142.89, ['z'] = 8.12 },
		[42] = { ['x'] = -1049.5, ['y'] = -1912.78, ['z'] = 12.43 },
		[43] = { ['x'] = -904.74, ['y'] = -1765.00, ['z'] = 18.71 },
		[44] = { ['x'] = -807.23, ['y'] = -1661.60, ['z'] = 16.12 },
		[45] = { ['x'] = -675.59, ['y'] = -1469.46, ['z'] = 9.845 },
		[46] = { ['x'] = -543.97, ['y'] = -1164.19, ['z'] = 18.42 },
		[47] = { ['x'] = -511.73, ['y'] = -914.69, ['z'] = 24.99 },
		[48] = { ['x'] = -543.28, ['y'] = -685.141, ['z'] = 32.62 },
		[49] = { ['x'] = -676.25, ['y'] = -356.439, ['z'] = 34.00 },
		[50] = { ['x'] = -997.75, ['y'] = -233.412, ['z'] = 37.04 },
		[51] = { ['x'] = -1393.34, ['y'] = -389.99, ['z'] = 36.03 },
		[52] = { ['x'] = -1512.93, ['y'] = -385.04, ['z'] = 40.63 },
		[53] = { ['x'] = -1529.08, ['y'] = -298.27, ['z'] = 48.07 },
		[54] = { ['x'] = -1422.66, ['y'] = -179.78, ['z'] = 46.85 },
		[55] = { ['x'] = -1376.62, ['y'] = -67.56, ['z'] = 51.56 },
		[56] = { ['x'] = -1165.39, ['y'] = -137.64, ['z'] = 39.06 },
		[57] = { ['x'] = -922.89, ['y'] = -137.69, ['z'] = 37.11 },
		[58] = { ['x'] = -614.51, ['y'] = -9.60, ['z'] = 42.00 },
		[59] = { ['x'] = -327.01, ['y'] = -28.98, ['z'] = 47.39 },
		[60] = { ['x'] = -290.85, ['y'] = -209.46, ['z'] = 37.40 },
		[61] = { ['x'] = -281.70, ['y'] = -334.46, ['z'] = 29.36 },
		[62] = { ['x'] = -231.29, ['y'] = -571.77, ['z'] = 33.91 },
		[63] = { ['x'] = -349.05, ['y'] = -711.85, ['z'] = 32.52 },
		[64] = { ['x'] = -350.51, ['y'] = -755.03, ['z'] = 33.32 },
	}
}
-----------------------------------------------------------------------------------------------------------------------------------------
-- STARTRACES
-----------------------------------------------------------------------------------------------------------------------------------------
Citizen.CreateThread(function()
	while true do
		local phSleep = 300
			if not inrace then
				local ped = PlayerPedId()
				local vehicle = GetVehiclePedIsUsing(ped)
				local x,y,z = table.unpack(GetEntityCoords(ped))
				local bowz,cdz = GetGroundZFor_3dCoord(CoordenadaX,CoordenadaY,CoordenadaZ)
				local distance = GetDistanceBetweenCoords(CoordenadaX,CoordenadaY,cdz,x,y,z,true)
				if distance <= 30.0 then
					phSleep = 4
					if IsEntityAVehicle(vehicle) and GetVehicleClass(vehicle) ~= 15 and GetPedInVehicleSeat(vehicle,-1) == ped then
						DrawMarker(23,CoordenadaX,CoordenadaY,CoordenadaZ-0.96,0,0,0,0,0,0,20.0,20.0,1.0,255,0,0,50,0,0,0,0)
						if distance <= 10.0 then
							DrawText3D(CoordenadaX,CoordenadaY,CoordenadaZ, 'Pressione [~g~E~w~] para iniciar a corrida')
							if IsControlJustPressed(0,38) and vCORRIDAS.checkPermission() and not vCORRIDAS.searchTimer() then
							-- if IsControlJustPressed(0,38) and vCORRIDAS.checkPermission() then
								vCORRIDAS.setSearchTimer()
								inrace = true							
								racepos = 1
								racepoint = vCORRIDAS.getRacepoint()
								timerace = races[racepoint]["time"]
								PlateIndex = GetVehicleNumberPlateText(vehicle)
								SetVehicleNumberPlateText(vehicle, 'CORREDOR')
								raceBlip(races, racepoint, racepos)
								vCORRIDAS.startBombRace()
								startRace()
								bomba = CreateObject(GetHashKey('prop_c4_final_green'),x,y,z,true,true,true)
								AttachEntityToEntity(bomba,vehicle,GetEntityBoneIndexByName(vehicle,'exhaust'),0.0,0.0,0.0,180.0,-90.0,180.0,false,false,false,true,2,true)
								PlaySoundFrontend(-1,'Oneshot_Final','MP_MISSION_COUNTDOWN_SOUNDSET',false)
								TriggerEvent("Notify","negado","Você começou uma corrida <b>Explosiva</b>, não saia do veículo e termine no tempo estimado, ou então seu veículo vai explodir com você dentro.",5000)
							end
						end
					end
				end
			end
			Wait(phSleep)
		end
	end)

function startRace()
	-----------------------------------------------------------------------------------------------------------------------------------------
	-- CHECKPOINTS
	-----------------------------------------------------------------------------------------------------------------------------------------
	Citizen.CreateThread(function()
		local newRaceCheckPoint = racepos + 1
		checkpoint = CreateCheckpoint(12, races[racepoint][racepos]['x'], races[racepoint][racepos]['y'], races[racepoint][racepos]['z'] + 2,
										  races[racepoint][racepos + 1]['x'], races[racepoint][racepos + 1]['y'], races[racepoint][racepos + 1]['z'],
										  8.0, 0, 213, 255, 70, 0)
							  
		while inrace do
			local phSleep = 300
			if inrace then
				local ped = PlayerPedId()
				local vehicle = GetVehiclePedIsUsing(ped)
				local x,y,z = table.unpack(GetEntityCoords(ped))
				local bowz,cdz = GetGroundZFor_3dCoord(races[racepoint][racepos].x,races[racepoint][racepos].y,races[racepoint][racepos].z)
				local distance = GetDistanceBetweenCoords(races[racepoint][racepos].x,races[racepoint][racepos].y,cdz,x,y,z,true)
				if distance <= 100.0 then
					phSleep = 4
					if IsEntityAVehicle(vehicle) and GetVehicleClass(vehicle) ~= 15 then
						--DrawMarker(1,races[racepoint][racepos].x,races[racepoint][racepos].y,races[racepoint][racepos].z-3,0,0,0,0,0,0,12.0,12.0,8.0,255,255,255,25,0,0,0,0)
						--DrawMarker(21,races[racepoint][racepos].x,races[racepoint][racepos].y,races[racepoint][racepos].z+1,0,0,0,0,180.0,130.0,3.0,3.0,2.0,255,0,0,50,1,0,0,1)
						if distance <= 15.1 then
							DeleteCheckpoint(checkpoint)
							RemoveBlip(blips)
							if racepos == #races[racepoint] then
								inrace = false
								SetVehicleNumberPlateText(GetPlayersLastVehicle(),PlateIndex)
								PlateIndex = nil
								PlaySoundFrontend(-1,'RACE_PLACED', 'HUD_AWARDS', false)
								DeleteObject(bomba)
								vCORRIDAS.removeBombRace()
								vCORRIDAS.paymentCheck(racepoint,2)
							else
								racepos = racepos + 1
								if racepos == #races[racepoint] then 
									checkpoint = CreateCheckpoint(16, races[racepoint][racepos]['x'], races[racepoint][racepos]['y'], races[racepoint][racepos]['z'] + 2,
																	  races[racepoint][racepos]['x'], races[racepoint][racepos]['y'], races[racepoint][racepos]['z'],
																	  8.0, 0, 255, 0, 70, 0)
								else 									
									checkpoint = CreateCheckpoint(12, races[racepoint][racepos]['x'], races[racepoint][racepos]['y'], races[racepoint][racepos]['z'] + 2,
																	  races[racepoint][racepos + 1]['x'], races[racepoint][racepos + 1]['y'], races[racepoint][racepos + 1]['z'],
																	  8.0, 0, 213, 255, 70, 0)
								end
								raceBlip(races,racepoint,racepos)
							end
						end
					end
				end
			else 
				break
			end
			Citizen.Wait(phSleep)
		end
	end)
	-----------------------------------------------------------------------------------------------------------------------------------------
	-- TIMEDRAWN
	-----------------------------------------------------------------------------------------------------------------------------------------
	Citizen.CreateThread(function()
		while inrace do
			local phSleep = 300
			if inrace and timerace > 0 and GetVehiclePedIsUsing(PlayerPedId()) then
				phSleep = 4
				ph_raceText('RESTAM ~g~'..timerace..' SEGUNDOS ~w~PARA CHEGAR AO DESTINO FINAL DA CORRIDA. CHECKPOINT ('..racepos..' / '..#races[racepoint]..')',4,0.5,0.905,0.45,255,255,255,100)
				ph_raceText('VENÇA A CORRIDA E SUPERE SEUS PROPRIOS RECORDES ANTES DO TEMPO ACABAR',4,0.5,0.93,0.38,255,255,255,100)
			else 
				break
			end
			Citizen.Wait(phSleep)
		end
	end)
	-----------------------------------------------------------------------------------------------------------------------------------------
	-- TIMERACE
	-----------------------------------------------------------------------------------------------------------------------------------------
	Citizen.CreateThread(function()
		while inrace do
			Citizen.Wait(1000)
			if inrace and timerace > 0 then
				timerace = timerace - 1
				if timerace <= 0 or not IsPedInAnyVehicle(PlayerPedId()) then
					inrace = false
					RemoveBlip(blips)
					SetVehicleNumberPlateText(GetPlayersLastVehicle(),PlateIndex)
					PlateIndex = nil
					PlaySoundFrontend(-1,'RACE_PLACED', 'HUD_AWARDS', false)
					Citizen.Wait(5)
					SetTimeout(200, function()
						DeleteObject(bomba)
						vCORRIDAS.removeBombRace()
						AddExplosion(GetEntityCoords(GetPlayersLastVehicle()), 5, 50.0, true, false, true)	
						DeleteCheckpoint(checkpoint)
					end)
				end
			else 
				break
			end
		end
	end)
end 

-----------------------------------------------------------------------------------------------------------------------------------------
-- REMOVEBOMB
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNetEvent('emp_race:unbomb')
AddEventHandler('emp_race:unbomb',function()
	inrace = false
	SetVehicleNumberPlateText(GetPlayersLastVehicle(),PlateIndex)
	PlateIndex = nil
	RemoveBlip(blips)
	DeleteObject(bomba)
	vCORRIDAS.removeBombRace()
	TriggerEvent("Notify","importante","A <b>Bomba</b> foi desarmada com sucesso.")
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- FUNÇÕES
-----------------------------------------------------------------------------------------------------------------------------------------
function ph_raceText(text,font,x,y,scale,r,g,b,a)
	SetTextFont(font)
	SetTextScale(scale,scale)
	SetTextColour(r,g,b,a)
	SetTextOutline()
	SetTextCentre(1)
	SetTextEntry('STRING')
	AddTextComponentString(text)
	DrawText(x,y)
end

function raceBlip(races,racepoint,racepos)
	blips = AddBlipForCoord(races[racepoint][racepos]["x"],races[racepoint][racepos]["y"],races[racepoint][racepos]["z"])
	SetBlipSprite(blips,1)
	SetBlipColour(blips,1)
	SetBlipScale(blips,0.4)
	SetBlipAsShortRange(blips,false)
	SetBlipRoute(blips,true)
	BeginTextCommandSetBlipName('STRING')
	AddTextComponentString('Corrida Clandestina')
	EndTextCommandSetBlipName(blips)
end

function DrawText3D(x, y, z, text)
    local onScreen,_x,_y=World3dToScreen2d(x,y,z)
    local px,py,pz=table.unpack(GetGameplayCamCoords())    
    SetTextScale(0.35, 0.35)
    SetTextFont(4)
    SetTextProportional(1)
    SetTextColour(255, 255, 255, 215)
    SetTextEntry("STRING")
    SetTextCentre(1)
    AddTextComponentString(text)
    DrawText(_x,_y)
    local factor = (string.len(text)) / 370
    DrawRect(_x,_y+0.0125, 0.015+ factor, 0.03, 41, 11, 41, 68)
end